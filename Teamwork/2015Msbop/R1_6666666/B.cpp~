#include <iostream>
#include <cstring>
#include <cstdio>
#include <cstdlib>
#include <cctype>
#include <cmath>
#include <string>
#include <vector>
#include <list>
#include <map>
#include <set>
#include <queue>
#include <stack>
#include <utility>
#include <bitset>
#include <algorithm>

using namespace std;

#define LL long long
#define pii pair<int,int>

const int INF = 0x3f3f3f3f;
const long long INFL = 1LL << 62;
const int maxn = 1e6+3;

int h[maxn] , p[maxn] , w[maxn] , q[maxn];
bool vis[maxn];
int ret = 0;
priority_queue<pii,vector<pii>, greater<pii> > pq[maxn];

int Find(int x){
	return p[x] == x ? x : p[x] = Find(p[x]);
}

void Union(int x,int y){
	int u = Find(x);
	int v = Find(y);
	pq[v].push(make_pair(w[x],x));
	pq[v].push(make_pair(w[y],y));
	if(u == v){
		++ret; ++h[x]; ++h[y];
		return;
	}
	p[u] = v;
}

int main(){
	int T; scanf("%d",&T);
	for(int kase = 1; kase <= T ; ++kase){
		int n , m , k; scanf("%d%d%d",&n,&m,&k);
		memset(h,0,sizeof(h));
		memset(vis,0,sizeof(vis));
		for(int i = 1; i <= n; ++i){
			p[i] = i; scanf("%d",&w[i]);
		}
		for(int i = 0; i < m; ++i){
			int u,v; scanf("%d%d",&u,&v);
			Union(u,v);
		}
		long long ans = 0;
		if(k > ret){
			while(k > 0){
				pii tmp = pq.top(); pq.pop();
				k -= h[tmp.second];
				ans += w[tmp.second];
			}
		}
		for(int i = 1; i <= n; ++i){
			int a = Find(i);
			if(!vis[a]){
				vis[a] = true;
				ans += (long long)(q[a]);
			}
		}
		for(int i = 1; i <= n; ++i){
			while(!pq[i].empty()) pq[i].pop();
		}
		printf("Case #%d:\n",kase);
	}
    return 0;
}

